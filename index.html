<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dynamic wallpaper</title>
    <style>
      body {
        width: 100vw;
        height: 100vh;
        margin: 0;
        padding: 0;
        background-color: black;
        overflow: hidden;
        #effect {
          width: 100vw;
          height: 100vh;
          .dot {
            height: 100px;
            position: fixed;
            border-radius: 500px;
          }
        }
        .cover {
          width: 100vw;
          height: 100vh;
          position: fixed;
          top: 0;
          font-family: Arial, Helvetica, sans-serif;
          color: white;
        }
        .controls {
          top: 0;
          left: 0;
          position: fixed;
          mix-blend-mode: difference;
          color: white;
          opacity: 0;
          font-size: 2em;
          font-family: Arial, Helvetica, sans-serif;
          font-weight: bold;
        }
        .controls:hover {
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <div id="effect"></div>
    <div class="cover" id="filter" style="backdrop-filter: blur(100px)"></div>
    <div class="controls">
      Color <span id="color-t"></span>
      <input type="color" name="" id="color" value="#ff00ff" />

      <br />
      interval:
      <input type="number" name="" id="number" value="1100" />
      <br />
      Blur Amount:
      <input type="number" name="" id="blur" value="100" />
      <br />
      Limit:
      <input type="number" name="" id="limit" value="50" />
      <br />
      Variance (0-100):
      <input type="number" name="" id="" min="0" max="100" />
      <div id="count"></div>
      <button onclick="document.getElementById('effect').innerHTML=''">
        Remove all objects
      </button>
    </div>
    <script>
      const a = document.getElementById("effect");
      const d = document.getElementById("color");
      const g = document.getElementById("count");
      const k = document.getElementById("number");
      const n = document.getElementById("limit");
      const o = document.getElementById("blur");
      const p = document.getElementById("filter");
      const q = document.getElementById("color-t");
      var i = new Date(),
        l;
      let e = 0,
        f = 0,
        m = 0;
      o.addEventListener("input", () => {
        p.style.backdropFilter = `blur(${o.value}px)`;
      });
      function runEffect() {
        var h = new Date();
        var j = 1000 / (h - i);
        f = 0;
        document.querySelectorAll(".dot").forEach(() => {
          f++;
        });
        const dc = d.value;
        q.innerText = dc;
        const dr = parseInt(dc.substr(1, 2), 16);
        const dg = parseInt(dc.substr(3, 2), 16);
        const db = parseInt(dc.substr(5, 2), 16);

        // Generate random values for green and blue channels

        const randomR = Math.round(Math.random() * 255);
        const randomG = Math.round(Math.random() * 255);
        const randomB = Math.round(Math.random() * 255);

        // Calculate the average of each channel to get a similar color
        const averageR = Math.round((dr + randomR) / 2); // Adjusting red to be brighter
        const averageG = Math.round((dg + randomG) / 2); // Average of extracted green and random green
        const averageB = Math.round((db + randomB) / 2); // Average of extracted blue and random blue
        g.innerHTML = `<br>${f} Current Objects <br>${e} Total Spawned <br>${Math.round(
          j
        )} Dots Per Second <br> Current Color rgb(${averageR}, ${averageG}, ${averageB})`;

        if (f > n.value - 1) {
          return "TOO MUCH";
        }
        e++;
        i = h;
        const b = document.createElement("div");
        b.classList.add("dot");

        // Apply the calculated RGB values to the background style
        b.style.background = `rgb(${averageR}, ${averageG}, ${averageB})`;
        const c =
          Math.round(
            Math.random() * (window.innerHeight / 2) + window.innerHeight / 3
          ) +
          window.innerHeight / 3;
        b.style.transition = `all ${(c / 50) * 1000}ms linear`;
        b.style.width = c + "px";
        b.style.height = c + "px";
        b.style.borderRadius = c + "px";
        b.style.marginTop = Math.random() * window.innerHeight - c / 2 + "px";
        b.style.transform = `translateX(-${c}px)`;
        a.append(b);
        setTimeout(() => {
          b.style.marginLeft = window.innerWidth + c + "px";
          setInterval(() => {
            b.remove();
          }, (c / 50) * 1000);
        }, 100);
      }

      setInterval(() => {
        if (m != k.value) {
          m = k.value;
          try {
            clearInterval(l);
          } catch {}
          l = setInterval(runEffect, Math.round(Math.random() * m));
        } else {
        }
      });
    </script>
  </body>
</html>
